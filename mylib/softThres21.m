%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  x^* = argmin_x 0.5*(x-a) + \lambda * |x|_2,1
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function x = softThres21(a, tau, n)

s = sqrt(a(1:n).^2 + a(n+1:2*n).^2+a(2*n+1:end).^2);
x = [max(s-tau,0).*a(1:n)./s ;
        max(s-tau,0).*a(n+1:2*n)./s;max(s-tau,0).*a(2*n+1:end)./s ];
end